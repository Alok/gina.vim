Describe gina#command#log
  Before all
    let Path = vital#gina#import('System.Filepath')
    let root = tempname()
    let slit1 = Slit(Path.join(root, 'valid'), 1)
    call slit1.write('A/foo.txt', [])
    call slit1.write('B/foo.txt', [])
    call slit1.write('C/foo.txt', [])

    call slit1.execute('add %s', slit1.path('A/foo.txt'))
    call slit1.execute('commit --quiet -m "First"')
    call slit1.execute('checkout -b develop')
    call slit1.execute('add %s', slit1.path('B/foo.txt'))
    call slit1.execute('commit --quiet -m "Second"')
    call slit1.execute('checkout master')
    call slit1.execute('add %s', slit1.path('C/foo.txt'))
    call slit1.execute('commit --quiet -m "Thrid"')
  End

  After all
    let File = vital#gina#import('System.File')
    call File.rmdir(root, 'r')
    call gina#core#clear()
  End

  Before
    silent! windo bwipeout!
    silent! bufdo bwipeout!
    execute 'edit' fnameescape(Path.join(slit1.worktree, 'A', 'foo.txt'))
  End

  Describe Use cases
    It might be called without arguments
      GinaSync log
      Assert Equals(winnr('$'), 2)
      Assert Equals(bufname('%'), 'gina://valid:log')
      Assert Match(
            \ getline(1),
            \ '\* [32m\w\{7}[m - Thrid [33;1m\d\+ seconds\? ago[m [35;1m<.*>[m[36;1m (HEAD -> master)[m'
            \)
      Assert Match(
            \ getline(2),
            \ '\* [32m\w\{7}[m - First [33;1m\d\+ seconds\? ago[m [35;1m<.*>[m[36;1m[m'
            \)
      Assert Equals(line('$'), 2)
    End

    It might be called with -- %
      GinaSync log -- %
      Assert Equals(winnr('$'), 2)
      Assert Equals(bufname('%'), 'gina://valid:log/:A/foo.txt')
      Assert Match(
            \ getline(1),
            \ '\* [32m\w\{7}[m - First [33;1m\d\+ seconds\? ago[m [35;1m<.*>[m[36;1m[m'
            \)
      Assert Equals(line('$'), 1)
    End
  End
End
