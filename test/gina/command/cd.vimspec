Describe gina#command#cd
  Before all
    let Path = vital#gina#import('System.Filepath')
    let root = tempname()
    let slit1 = Slit(Path.join(root, 'valid'), 1)
    call slit1.write('A/foo/bar.txt', [])
    let cwd = getcwd()
  End

  After all
    let File = vital#gina#import('System.File')
    call File.rmdir(root, 'r')
    call gina#core#clear()
  End

  Before
    silent! windo bwipeout!
    silent! bufdo bwipeout!
    edit foo
    execute 'new' fnameescape(Path.join(slit1.worktree, 'A', 'foo.txt'))
  End

  After
    execute 'cd' fnameescape(cwd)
  End

  Describe Use cases
    It might be called without arguments
      GinaSync cd
      Assert Equals(getcwd(), slit1.worktree)
      silent wincmd p
      Assert Equals(getcwd(), slit1.worktree)
    End

    It might be called with 'A/foo'
      GinaSync cd A/foo
      Assert Equals(
            \ getcwd(),
            \ Path.join(slit1.worktree, 'A', 'foo')
            \)
      silent wincmd p
      Assert Equals(
            \ getcwd(),
            \ Path.join(slit1.worktree, 'A', 'foo')
            \)
    End
  End
End
